<project>
    <!-- Used for main.class, jar.name -->
    <property file = "project.properties"/>
    <property name = "compile.dest.dir" location = "${build.dir}/classes"/>
    <property name = "jar.file" location= "${dist.dir}/${jar.name}"/>
    <property name = "ant.lib" location = "${ant.home}/lib"/>
    <property name = "project.lib" location = "lib"/>
    
    <!-- Classpath for the project -->	
    <path id="project.class.path">
      <fileset dir="${ant.lib}">
        <include name="*.jar"/>
      </fileset>
      <pathelement path = "${compile.dest.dir}"/>
      <fileset dir="${project.lib}">
        <include name="*.jar"/>
      </fileset>
    </path>
    
    <!-- Delete autogenerated files and directories. -->
    <target name = "clean"
            description = "Delete automatically generated dependencies.">
        <delete dir = "${dist.dir}"/>
        <delete dir = "${build.dir}"/>
        <delete dir = "${results.dir}"/>
    </target>
    
    <!-- Create build dependencies like folders. -->
    <target name = "prebuild"
            description = "Generate dependencies like folders.">
        <mkdir dir = "${dist.dir}"/>
        <mkdir dir = "${compile.dest.dir}"/>
        <mkdir dir = "${results.dir}"/>
        <mkdir dir = "${source.dir}"/>
        <available classname="${require.class}"
           classpathref="project.class.path"
           property="required.class.present"/>
        <fail unless = "required.class.present">
            ${require.class} not in the class path.
Please add the appropriate jar to the ${ant.lib} folder.
The jar could be similar to ${manifest.class.path}
        </fail>
    </target>
    
    <!-- Compile java files into the build folder. -->
    <target name = "compile" depends = "prebuild"
        description = "Compile java files.">
        <javac srcdir = "${source.dir}" destdir = "${compile.dest.dir}" 
         debug = "on">
            <classpath refid = "project.class.path"/>
            <!--<compilerarg value="-Xlint"/>-->
        </javac>
    </target>
    
    <!-- Puts the java files into a jar. -->
    <target name = "jar" depends = "compile"
            description = "Create a jar.">
        <fail unless = "main.class"/>
        <jar destfile = "${jar.file}">
            <fileset dir = "${compile.dest.dir}" includes="*.class"/>
            <manifest>
                <attribute name = "Main-Class"
                    value = "${manifest.class.path}"/>
                <attribute name = "Class-Path" value = "${class.path}"/>
            </manifest>
        </jar>
    </target>
    
    <!-- Run the program. -->
    <target name = "run" depends = "jar"
            description = "Run the program.">
        <java classname = "${main.class}"
         fork = "true"
         failonerror = "true" >
            <classpath refid = "project.class.path"/>
        </java>
    </target>
</project>
